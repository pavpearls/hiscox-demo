<!-- Main Template -->

<div class="event-catalog">
  <h3>Event Catalog</h3>
  <nz-divider nzType="vertical"></nz-divider>

  <!-- Loading or Error States -->
  <ng-container *ngIf="isInProgress(eventsTypeList$ | async) || isInProgress(regionPerilList$ | async); else checkError">
    <ng-container *ngTemplateOutlet="loadingTemplate"></ng-container>
  </ng-container>

  <ng-container *ngIf="isFailure(eventsTypeList$ | async) || isFailure(regionPerilList$ | async); else checkSuccess">
    <ng-container *ngTemplateOutlet="errorTemplate"></ng-container>
  </ng-container>

  <!-- Success State: Display Buttons and Tab Content -->
  <ng-container *ngIf="isSuccess(eventsTypeList$ | async) && isSuccess(regionPerilList$ | async)">
    <ng-container *ngTemplateOutlet="buttonsTemplate"></ng-container>
    <ng-container *ngTemplateOutlet="tabContentTemplate"></ng-container>
  </ng-container>
</div>

<!-- Individual Templates -->

<!-- Buttons Template -->
<ng-template #buttonsTemplate>
  <div class="tab-buttons">
    <button 
      nz-button 
      nzType="default" 
      [ngClass]="{ 'active-tab': selectedTab === 'rds' }"
      (click)="setActiveTab('rds')">
      RDS
    </button>

    <button 
      nz-button 
      nzType="default" 
      [ngClass]="{ 'active-tab': selectedTab === 'postEvent' }"
      (click)="setActiveTab('postEvent')">
      Post Event
    </button>

    <button 
      nz-button 
      nzType="default" 
      [ngClass]="{ 'active-tab': selectedTab === 'eventResponse' }"
      (click)="setActiveTab('eventResponse')">
      Event Response
    </button>
  </div>
</ng-template>

<!-- Tab Content Template -->
<ng-template #tabContentTemplate>
  <ng-container *ngIf="selectedTab === 'rds'">
    <app-rds-event></app-rds-event>
  </ng-container>

  <ng-container *ngIf="selectedTab === 'postEvent'">
    <app-post-event></app-post-event>
  </ng-container>

  <ng-container *ngIf="selectedTab === 'eventResponse'">
    <app-event-response></app-event-response>
  </ng-container>
</ng-template>

<!-- Loading Template -->
<ng-template #loadingTemplate>
  <nz-spin></nz-spin>
  <p>Loading data...</p>
</ng-template>

<!-- Error Template -->
<ng-template #errorTemplate>
  <p>Error loading data. Please try again later.</p>
</ng-template>
